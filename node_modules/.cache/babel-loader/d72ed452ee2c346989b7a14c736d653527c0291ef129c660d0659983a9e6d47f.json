{"ast":null,"code":"import { warning } from '../../../vc-util/warning';\nimport { ref } from 'vue';\n/**\n * Keep input cursor in the correct position if possible.\n * Is this necessary since we have `formatter` which may mass the content?\n */\nexport default function useCursor(inputRef, focused) {\n  var selectionRef = ref(null);\n  function recordCursor() {\n    // Record position\n    try {\n      var _inputRef$value = inputRef.value,\n        start = _inputRef$value.selectionStart,\n        end = _inputRef$value.selectionEnd,\n        value = _inputRef$value.value;\n      var beforeTxt = value.substring(0, start);\n      var afterTxt = value.substring(end);\n      selectionRef.value = {\n        start: start,\n        end: end,\n        value: value,\n        beforeTxt: beforeTxt,\n        afterTxt: afterTxt\n      };\n    } catch (e) {\n      // Fix error in Chrome:\n      // Failed to read the 'selectionStart' property from 'HTMLInputElement'\n      // http://stackoverflow.com/q/21177489/3040605\n    }\n  }\n  /**\n   * Restore logic:\n   *  1. back string same\n   *  2. start string same\n   */\n  function restoreCursor() {\n    if (inputRef.value && selectionRef.value && focused.value) {\n      try {\n        var value = inputRef.value.value;\n        var _selectionRef$value = selectionRef.value,\n          beforeTxt = _selectionRef$value.beforeTxt,\n          afterTxt = _selectionRef$value.afterTxt,\n          start = _selectionRef$value.start;\n        var startPos = value.length;\n        if (value.endsWith(afterTxt)) {\n          startPos = value.length - selectionRef.value.afterTxt.length;\n        } else if (value.startsWith(beforeTxt)) {\n          startPos = beforeTxt.length;\n        } else {\n          var beforeLastChar = beforeTxt[start - 1];\n          var newIndex = value.indexOf(beforeLastChar, start - 1);\n          if (newIndex !== -1) {\n            startPos = newIndex + 1;\n          }\n        }\n        inputRef.value.setSelectionRange(startPos, startPos);\n      } catch (e) {\n        warning(false, \"Something warning of cursor restore. Please fire issue about this: \".concat(e.message));\n      }\n    }\n  }\n  return [recordCursor, restoreCursor];\n}","map":{"version":3,"names":["warning","ref","useCursor","inputRef","focused","selectionRef","recordCursor","_inputRef$value","value","start","selectionStart","end","selectionEnd","beforeTxt","substring","afterTxt","e","restoreCursor","_selectionRef$value","startPos","length","endsWith","startsWith","beforeLastChar","newIndex","indexOf","setSelectionRange","concat","message"],"sources":["/Users/dev/e-approver/node_modules/ant-design-vue/es/input-number/src/hooks/useCursor.js"],"sourcesContent":["import { warning } from '../../../vc-util/warning';\nimport { ref } from 'vue';\n/**\n * Keep input cursor in the correct position if possible.\n * Is this necessary since we have `formatter` which may mass the content?\n */\nexport default function useCursor(inputRef, focused) {\n  var selectionRef = ref(null);\n  function recordCursor() {\n    // Record position\n    try {\n      var _inputRef$value = inputRef.value,\n        start = _inputRef$value.selectionStart,\n        end = _inputRef$value.selectionEnd,\n        value = _inputRef$value.value;\n      var beforeTxt = value.substring(0, start);\n      var afterTxt = value.substring(end);\n      selectionRef.value = {\n        start: start,\n        end: end,\n        value: value,\n        beforeTxt: beforeTxt,\n        afterTxt: afterTxt\n      };\n    } catch (e) {\n      // Fix error in Chrome:\n      // Failed to read the 'selectionStart' property from 'HTMLInputElement'\n      // http://stackoverflow.com/q/21177489/3040605\n    }\n  }\n  /**\n   * Restore logic:\n   *  1. back string same\n   *  2. start string same\n   */\n  function restoreCursor() {\n    if (inputRef.value && selectionRef.value && focused.value) {\n      try {\n        var value = inputRef.value.value;\n        var _selectionRef$value = selectionRef.value,\n          beforeTxt = _selectionRef$value.beforeTxt,\n          afterTxt = _selectionRef$value.afterTxt,\n          start = _selectionRef$value.start;\n        var startPos = value.length;\n        if (value.endsWith(afterTxt)) {\n          startPos = value.length - selectionRef.value.afterTxt.length;\n        } else if (value.startsWith(beforeTxt)) {\n          startPos = beforeTxt.length;\n        } else {\n          var beforeLastChar = beforeTxt[start - 1];\n          var newIndex = value.indexOf(beforeLastChar, start - 1);\n          if (newIndex !== -1) {\n            startPos = newIndex + 1;\n          }\n        }\n        inputRef.value.setSelectionRange(startPos, startPos);\n      } catch (e) {\n        warning(false, \"Something warning of cursor restore. Please fire issue about this: \".concat(e.message));\n      }\n    }\n  }\n  return [recordCursor, restoreCursor];\n}"],"mappings":"AAAA,SAASA,OAAO,QAAQ,0BAA0B;AAClD,SAASC,GAAG,QAAQ,KAAK;AACzB;AACA;AACA;AACA;AACA,eAAe,SAASC,SAASA,CAACC,QAAQ,EAAEC,OAAO,EAAE;EACnD,IAAIC,YAAY,GAAGJ,GAAG,CAAC,IAAI,CAAC;EAC5B,SAASK,YAAYA,CAAA,EAAG;IACtB;IACA,IAAI;MACF,IAAIC,eAAe,GAAGJ,QAAQ,CAACK,KAAK;QAClCC,KAAK,GAAGF,eAAe,CAACG,cAAc;QACtCC,GAAG,GAAGJ,eAAe,CAACK,YAAY;QAClCJ,KAAK,GAAGD,eAAe,CAACC,KAAK;MAC/B,IAAIK,SAAS,GAAGL,KAAK,CAACM,SAAS,CAAC,CAAC,EAAEL,KAAK,CAAC;MACzC,IAAIM,QAAQ,GAAGP,KAAK,CAACM,SAAS,CAACH,GAAG,CAAC;MACnCN,YAAY,CAACG,KAAK,GAAG;QACnBC,KAAK,EAAEA,KAAK;QACZE,GAAG,EAAEA,GAAG;QACRH,KAAK,EAAEA,KAAK;QACZK,SAAS,EAAEA,SAAS;QACpBE,QAAQ,EAAEA;MACZ,CAAC;IACH,CAAC,CAAC,OAAOC,CAAC,EAAE;MACV;MACA;MACA;IAAA;EAEJ;EACA;AACF;AACA;AACA;AACA;EACE,SAASC,aAAaA,CAAA,EAAG;IACvB,IAAId,QAAQ,CAACK,KAAK,IAAIH,YAAY,CAACG,KAAK,IAAIJ,OAAO,CAACI,KAAK,EAAE;MACzD,IAAI;QACF,IAAIA,KAAK,GAAGL,QAAQ,CAACK,KAAK,CAACA,KAAK;QAChC,IAAIU,mBAAmB,GAAGb,YAAY,CAACG,KAAK;UAC1CK,SAAS,GAAGK,mBAAmB,CAACL,SAAS;UACzCE,QAAQ,GAAGG,mBAAmB,CAACH,QAAQ;UACvCN,KAAK,GAAGS,mBAAmB,CAACT,KAAK;QACnC,IAAIU,QAAQ,GAAGX,KAAK,CAACY,MAAM;QAC3B,IAAIZ,KAAK,CAACa,QAAQ,CAACN,QAAQ,CAAC,EAAE;UAC5BI,QAAQ,GAAGX,KAAK,CAACY,MAAM,GAAGf,YAAY,CAACG,KAAK,CAACO,QAAQ,CAACK,MAAM;QAC9D,CAAC,MAAM,IAAIZ,KAAK,CAACc,UAAU,CAACT,SAAS,CAAC,EAAE;UACtCM,QAAQ,GAAGN,SAAS,CAACO,MAAM;QAC7B,CAAC,MAAM;UACL,IAAIG,cAAc,GAAGV,SAAS,CAACJ,KAAK,GAAG,CAAC,CAAC;UACzC,IAAIe,QAAQ,GAAGhB,KAAK,CAACiB,OAAO,CAACF,cAAc,EAAEd,KAAK,GAAG,CAAC,CAAC;UACvD,IAAIe,QAAQ,KAAK,CAAC,CAAC,EAAE;YACnBL,QAAQ,GAAGK,QAAQ,GAAG,CAAC;UACzB;QACF;QACArB,QAAQ,CAACK,KAAK,CAACkB,iBAAiB,CAACP,QAAQ,EAAEA,QAAQ,CAAC;MACtD,CAAC,CAAC,OAAOH,CAAC,EAAE;QACVhB,OAAO,CAAC,KAAK,EAAE,qEAAqE,CAAC2B,MAAM,CAACX,CAAC,CAACY,OAAO,CAAC,CAAC;MACzG;IACF;EACF;EACA,OAAO,CAACtB,YAAY,EAAEW,aAAa,CAAC;AACtC"},"metadata":{},"sourceType":"module","externalDependencies":[]}