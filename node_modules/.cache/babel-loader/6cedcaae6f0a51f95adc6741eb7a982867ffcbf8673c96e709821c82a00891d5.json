{"ast":null,"code":"import { onBeforeUnmount, onMounted, watch, ref, computed } from 'vue';\nimport KeyCode from '../../_util/KeyCode';\nimport { addGlobalMousedownEvent, getTargetFromEvent } from '../utils/uiUtil';\nimport raf from '../../_util/raf';\nexport default function usePickerInput(_ref) {\n  var open = _ref.open,\n    value = _ref.value,\n    isClickOutside = _ref.isClickOutside,\n    triggerOpen = _ref.triggerOpen,\n    forwardKeydown = _ref.forwardKeydown,\n    _onKeydown = _ref.onKeydown,\n    blurToCancel = _ref.blurToCancel,\n    onSubmit = _ref.onSubmit,\n    onCancel = _ref.onCancel,\n    _onFocus = _ref.onFocus,\n    _onBlur = _ref.onBlur;\n  var typing = ref(false);\n  var focused = ref(false);\n  /**\n   * We will prevent blur to handle open event when user click outside,\n   * since this will repeat trigger `onOpenChange` event.\n   */\n  var preventBlurRef = ref(false);\n  var valueChangedRef = ref(false);\n  var preventDefaultRef = ref(false);\n  var inputProps = computed(function () {\n    return {\n      onMousedown: function onMousedown() {\n        typing.value = true;\n        triggerOpen(true);\n      },\n      onKeydown: function onKeydown(e) {\n        var preventDefault = function preventDefault() {\n          preventDefaultRef.value = true;\n        };\n        _onKeydown(e, preventDefault);\n        if (preventDefaultRef.value) return;\n        switch (e.which) {\n          case KeyCode.ENTER:\n            {\n              if (!open.value) {\n                triggerOpen(true);\n              } else if (onSubmit() !== false) {\n                typing.value = true;\n              }\n              e.preventDefault();\n              return;\n            }\n          case KeyCode.TAB:\n            {\n              if (typing.value && open.value && !e.shiftKey) {\n                typing.value = false;\n                e.preventDefault();\n              } else if (!typing.value && open.value) {\n                if (!forwardKeydown(e) && e.shiftKey) {\n                  typing.value = true;\n                  e.preventDefault();\n                }\n              }\n              return;\n            }\n          case KeyCode.ESC:\n            {\n              typing.value = true;\n              onCancel();\n              return;\n            }\n        }\n        if (!open.value && ![KeyCode.SHIFT].includes(e.which)) {\n          triggerOpen(true);\n        } else if (!typing.value) {\n          // Let popup panel handle keyboard\n          forwardKeydown(e);\n        }\n      },\n      onFocus: function onFocus(e) {\n        typing.value = true;\n        focused.value = true;\n        if (_onFocus) {\n          _onFocus(e);\n        }\n      },\n      onBlur: function onBlur(e) {\n        if (preventBlurRef.value || !isClickOutside(document.activeElement)) {\n          preventBlurRef.value = false;\n          return;\n        }\n        if (blurToCancel.value) {\n          setTimeout(function () {\n            var _document = document,\n              activeElement = _document.activeElement;\n            while (activeElement && activeElement.shadowRoot) {\n              activeElement = activeElement.shadowRoot.activeElement;\n            }\n            if (isClickOutside(activeElement)) {\n              onCancel();\n            }\n          }, 0);\n        } else if (open.value) {\n          triggerOpen(false);\n          if (valueChangedRef.value) {\n            onSubmit();\n          }\n        }\n        focused.value = false;\n        if (_onBlur) {\n          _onBlur(e);\n        }\n      }\n    };\n  });\n  // check if value changed\n  watch(open, function () {\n    valueChangedRef.value = false;\n  });\n  watch(value, function () {\n    valueChangedRef.value = true;\n  });\n  var globalMousedownEvent = ref();\n  // Global click handler\n  onMounted(function () {\n    globalMousedownEvent.value = addGlobalMousedownEvent(function (e) {\n      var target = getTargetFromEvent(e);\n      if (open.value) {\n        var clickedOutside = isClickOutside(target);\n        if (!clickedOutside) {\n          preventBlurRef.value = true;\n          // Always set back in case `onBlur` prevented by user\n          raf(function () {\n            preventBlurRef.value = false;\n          });\n        } else if (!focused.value || clickedOutside) {\n          triggerOpen(false);\n        }\n      }\n    });\n  });\n  onBeforeUnmount(function () {\n    globalMousedownEvent.value && globalMousedownEvent.value();\n  });\n  return [inputProps, {\n    focused: focused,\n    typing: typing\n  }];\n}","map":{"version":3,"names":["onBeforeUnmount","onMounted","watch","ref","computed","KeyCode","addGlobalMousedownEvent","getTargetFromEvent","raf","usePickerInput","_ref","open","value","isClickOutside","triggerOpen","forwardKeydown","_onKeydown","onKeydown","blurToCancel","onSubmit","onCancel","_onFocus","onFocus","_onBlur","onBlur","typing","focused","preventBlurRef","valueChangedRef","preventDefaultRef","inputProps","onMousedown","e","preventDefault","which","ENTER","TAB","shiftKey","ESC","SHIFT","includes","document","activeElement","setTimeout","_document","shadowRoot","globalMousedownEvent","target","clickedOutside"],"sources":["/Users/dev/e-approver/node_modules/ant-design-vue/es/vc-picker/hooks/usePickerInput.js"],"sourcesContent":["import { onBeforeUnmount, onMounted, watch, ref, computed } from 'vue';\nimport KeyCode from '../../_util/KeyCode';\nimport { addGlobalMousedownEvent, getTargetFromEvent } from '../utils/uiUtil';\nimport raf from '../../_util/raf';\nexport default function usePickerInput(_ref) {\n  var open = _ref.open,\n    value = _ref.value,\n    isClickOutside = _ref.isClickOutside,\n    triggerOpen = _ref.triggerOpen,\n    forwardKeydown = _ref.forwardKeydown,\n    _onKeydown = _ref.onKeydown,\n    blurToCancel = _ref.blurToCancel,\n    onSubmit = _ref.onSubmit,\n    onCancel = _ref.onCancel,\n    _onFocus = _ref.onFocus,\n    _onBlur = _ref.onBlur;\n  var typing = ref(false);\n  var focused = ref(false);\n  /**\n   * We will prevent blur to handle open event when user click outside,\n   * since this will repeat trigger `onOpenChange` event.\n   */\n  var preventBlurRef = ref(false);\n  var valueChangedRef = ref(false);\n  var preventDefaultRef = ref(false);\n  var inputProps = computed(function () {\n    return {\n      onMousedown: function onMousedown() {\n        typing.value = true;\n        triggerOpen(true);\n      },\n      onKeydown: function onKeydown(e) {\n        var preventDefault = function preventDefault() {\n          preventDefaultRef.value = true;\n        };\n        _onKeydown(e, preventDefault);\n        if (preventDefaultRef.value) return;\n        switch (e.which) {\n          case KeyCode.ENTER:\n            {\n              if (!open.value) {\n                triggerOpen(true);\n              } else if (onSubmit() !== false) {\n                typing.value = true;\n              }\n              e.preventDefault();\n              return;\n            }\n          case KeyCode.TAB:\n            {\n              if (typing.value && open.value && !e.shiftKey) {\n                typing.value = false;\n                e.preventDefault();\n              } else if (!typing.value && open.value) {\n                if (!forwardKeydown(e) && e.shiftKey) {\n                  typing.value = true;\n                  e.preventDefault();\n                }\n              }\n              return;\n            }\n          case KeyCode.ESC:\n            {\n              typing.value = true;\n              onCancel();\n              return;\n            }\n        }\n        if (!open.value && ![KeyCode.SHIFT].includes(e.which)) {\n          triggerOpen(true);\n        } else if (!typing.value) {\n          // Let popup panel handle keyboard\n          forwardKeydown(e);\n        }\n      },\n      onFocus: function onFocus(e) {\n        typing.value = true;\n        focused.value = true;\n        if (_onFocus) {\n          _onFocus(e);\n        }\n      },\n      onBlur: function onBlur(e) {\n        if (preventBlurRef.value || !isClickOutside(document.activeElement)) {\n          preventBlurRef.value = false;\n          return;\n        }\n        if (blurToCancel.value) {\n          setTimeout(function () {\n            var _document = document,\n              activeElement = _document.activeElement;\n            while (activeElement && activeElement.shadowRoot) {\n              activeElement = activeElement.shadowRoot.activeElement;\n            }\n            if (isClickOutside(activeElement)) {\n              onCancel();\n            }\n          }, 0);\n        } else if (open.value) {\n          triggerOpen(false);\n          if (valueChangedRef.value) {\n            onSubmit();\n          }\n        }\n        focused.value = false;\n        if (_onBlur) {\n          _onBlur(e);\n        }\n      }\n    };\n  });\n  // check if value changed\n  watch(open, function () {\n    valueChangedRef.value = false;\n  });\n  watch(value, function () {\n    valueChangedRef.value = true;\n  });\n  var globalMousedownEvent = ref();\n  // Global click handler\n  onMounted(function () {\n    globalMousedownEvent.value = addGlobalMousedownEvent(function (e) {\n      var target = getTargetFromEvent(e);\n      if (open.value) {\n        var clickedOutside = isClickOutside(target);\n        if (!clickedOutside) {\n          preventBlurRef.value = true;\n          // Always set back in case `onBlur` prevented by user\n          raf(function () {\n            preventBlurRef.value = false;\n          });\n        } else if (!focused.value || clickedOutside) {\n          triggerOpen(false);\n        }\n      }\n    });\n  });\n  onBeforeUnmount(function () {\n    globalMousedownEvent.value && globalMousedownEvent.value();\n  });\n  return [inputProps, {\n    focused: focused,\n    typing: typing\n  }];\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}